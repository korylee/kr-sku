import{d as B,o as a,c as f,a as s,w as V,v as k,F as g,r as y,b as W,e as M,f as N,g as b,m as q,h as H,i as w,t as A,u as E,j as K,k as z}from"./vendor.edcce8f5.js";const G=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&u(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(t){if(t.ep)return;t.ep=!0;const l=n(t);fetch(t.href,l)}};G();let J=0;const j=()=>J++;var Q=(e,o)=>{const n=e.__vccOpts||e;for(const[u,t]of o)n[u]=t;return n};const S={style:{border:"1px solid black",display:"flex"}},X={style:{width:"calc(100% - 24px)"}},Y=M("name: "),Z=M(" options: "),T=["onUpdate:modelValue"],I=["onUpdate:modelValue"],ee={style:{width:"24px"}},te=B({props:{value:{type:Object,default:()=>({name:"",options:[]})}},emits:["add:item"],setup(e,{emit:o}){const n=e,u=()=>{const{options:t}=n.value,l={uid:j(),value:"",selected:!1};t.push(l),o("add:item",l)};return(t,l)=>(a(),f("div",S,[s("div",X,[s("div",null,[Y,V(s("input",{"onUpdate:modelValue":l[0]||(l[0]=r=>e.value.name=r)},null,512),[[k,e.value.name]])]),s("div",null,[Z,(a(!0),f(g,null,y(e.value.options,(r,i)=>(a(),f("span",{key:i,class:"ml-2"},[V(s("input",{"onUpdate:modelValue":p=>r.selected=p,type:"checkbox"},null,8,T),[[W,r.selected]]),V(s("input",{"onUpdate:modelValue":p=>r.value=p},null,8,I),[[k,r.value]])]))),128)),s("button",{onClick:u,class:"ml-2"},"+")])]),s("div",ee,[s("button",{onClick:l[1]||(l[1]=r=>t.$emit("remove")),style:{width:"100%",height:"100%"}},"-")])]))}});var ne=Q(te,[["__scopeId","data-v-59ef578c"]]);function O(e){return e!=null&&e.length?e.length===1?e[0].map(o=>[o]):e.reduce((o,n)=>{const u=[];return o.forEach(t=>{n.forEach(l=>{u.push([...N(t),l])})}),u}):[]}function F(e,o){return!e.some(n=>!o.includes(n))}const P=()=>{};function U(e){const o=q(e,({options:n})=>n!=null&&n.length?n:H);return O(o)}const C=e=>e.map(o=>o.uid);function oe(e,{variations:o,descartesOptions:n,updateItem:u=P}){const t=[],l=[];n=n!=null?n:U(o),e.forEach((i,p)=>{let v=!0;n.forEach((d,c)=>{F(d,i.options)&&(l[c]||(v=!1),i.options=d,u==null||u(i,d,o),l[c]=!0)}),v&&t.push(p)});const r=t.length;for(let i=r-1;i>=0;i--){const p=t[i];e.splice(p,1)}}function le(e,{variations:o,descartesOptions:n,createItem:u=r=>({options:r}),updateItem:t=P,addItems:l=[]}){n=n!=null?n:U(o),n.forEach(r=>{if(e.findIndex(d=>{const c=F(d.options,r);return c&&(d.options=r,t==null||t(d,r,o)),c})!==-1||!(l!=null&&l.length?r.some(({uid:d})=>l.some(c=>d===c.uid)):!0))return;const v=u(r,o);e.push(v)})}function $(e,o){return e.map((n,u)=>o[u].options.findIndex(t=>t.uid===n))}function L(e,o){e.sort((n,u)=>parseInt($(C(n.options),o).join(""))-parseInt($(C(u.options),o).join("")))}const D=new WeakMap;function re(e,o,n,u,t=!0){var r;const l=(r=D.get(e))!=null?r:(()=>{const i=b(()=>U(e.value));return D.set(e,i),i})();return{descartesOptions:l,add:i=>{le(o.value,{variations:e.value,descartesOptions:l.value,updateItem:u,createItem:n,addItems:N(i)}),t&&L(o.value,e.value)},remove:()=>{oe(o.value,{variations:e.value,descartesOptions:l.value,updateItem:u}),t&&L(o.value,e.value)}}}const ue={style:{"margin-top":"30px"}},se=s("th",{scope:"col"},"\u5E93\u5B58",-1),ce=["onUpdate:modelValue"],ie=["onUpdate:modelValue"],ae=B({setup(e){const o=[{name:"\u989C\u8272",options:["red","green","blue"]}],n=w([]),u=b(()=>n.value.filter(({options:c})=>c==null?void 0:c.length));n.value=o.map(c=>({name:c.name,options:c.options.map(x=>({uid:j(),value:x,selected:!1})),uid:""}));const t=w([]),{add:l,remove:r,descartesUidArray:i}=re(u,t,void 0,void 0,!1),p=()=>{n.value.push({name:Date.now(),options:[]})},v=c=>{n.value.splice(c,1),r()},d=b(()=>u.value);return console.time("progress"),console.timeLog("progress",O([Array.from({length:50}),Array.from({length:50}),Array.from({length:50})])),console.timeEnd("progress"),(c,x)=>(a(),f("div",null,[(a(!0),f(g,null,y(n.value,(m,h)=>(a(),K(ne,{key:h,value:m,"onAdd:item":E(l),onRemove:_=>v(h)},null,8,["value","onAdd:item","onRemove"]))),128)),s("button",{onClick:p,style:{width:"100%"}},"+"),s("table",ue,[s("caption",null," sku \u5217\u8868"+A(t.value.length),1),s("tbody",null,[s("tr",null,[(a(!0),f(g,null,y(E(d),(m,h)=>(a(),f("th",{scope:"col",key:h},A(m.name),1))),128)),se]),(a(!0),f(g,null,y(t.value,(m,h)=>(a(),f("tr",{key:h},[(a(!0),f(g,null,y(m.options,_=>(a(),f("th",{scope:"row",key:_.uid},[V(s("input",{"onUpdate:modelValue":R=>_.value=R},null,8,ce),[[k,_.value]])]))),128)),s("td",null,[V(s("input",{"onUpdate:modelValue":_=>m.stock=_,type:"number"},null,8,ie),[[k,m.stock]])])]))),128))])])]))}});z(ae).mount("#app");
