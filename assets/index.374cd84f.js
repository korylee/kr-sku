import{d as B,o as a,c as f,a as s,w as V,v as k,F as g,r as y,b as W,e as M,f as b,g as U,t as w,u as E,h as q,i as H}from"./vendor.b276f923.js";const K=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&u(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}};K();let z=0;const N=()=>z++;var G=(e,o)=>{const t=e.__vccOpts||e;for(const[u,n]of o)t[u]=n;return t};const J={style:{border:"1px solid black",display:"flex"}},Q={style:{width:"calc(100% - 24px)"}},X=M("name: "),Y=M(" options: "),Z=["onUpdate:modelValue"],S=["onUpdate:modelValue"],T={style:{width:"24px"}},I=B({props:{value:{type:Object,default:()=>({name:"",options:[]})}},emits:["add:item"],setup(e,{emit:o}){const t=e,u=()=>{const{options:n}=t.value,l={uid:N(),value:"",selected:!1};n.push(l),o("add:item",l)};return(n,l)=>(a(),f("div",J,[s("div",Q,[s("div",null,[X,V(s("input",{"onUpdate:modelValue":l[0]||(l[0]=r=>e.value.name=r)},null,512),[[k,e.value.name]])]),s("div",null,[Y,(a(!0),f(g,null,y(e.value.options,(r,i)=>(a(),f("span",{key:i,class:"ml-2"},[V(s("input",{"onUpdate:modelValue":p=>r.selected=p,type:"checkbox"},null,8,Z),[[W,r.selected]]),V(s("input",{"onUpdate:modelValue":p=>r.value=p},null,8,S),[[k,r.value]])]))),128)),s("button",{onClick:u,class:"ml-2"},"+")])]),s("div",T,[s("button",{onClick:l[1]||(l[1]=r=>n.$emit("remove")),style:{width:"100%",height:"100%"}},"-")])]))}});var ee=G(I,[["__scopeId","data-v-59ef578c"]]);function O(e){return e!=null&&e!==void 0?Array.isArray(e)?e:[e]:[]}function j(e){return e!=null&&e.length?e.length===1?e[0].map(o=>[o]):e.reduce((o,t)=>{const u=[];return o.forEach(n=>{t.forEach(l=>{u.push([...O(n),l])})}),u}):[]}function F(e,o){return!e.some(t=>!o.includes(t))}const P=()=>{};function A(e){const o=e.filter(({options:t})=>t==null?void 0:t.length).map(({options:t})=>t);return j(o)}const C=e=>e.map(o=>o.uid);function te(e,{variations:o,descartesOptions:t,updateItem:u=P}){const n=[],l=[];t=t!=null?t:A(o),e.forEach((i,p)=>{let h=!0;t.forEach((d,c)=>{F(d,i.options)&&(l[c]||(h=!1),i.options=d,u==null||u(i,d,o),l[c]=!0)}),h&&n.push(p)});const r=n.length;for(let i=r-1;i>=0;i--){const p=n[i];e.splice(p,1)}}function ne(e,{variations:o,descartesOptions:t,createItem:u=r=>({options:r}),updateItem:n=P,addItems:l=[]}){t=t!=null?t:A(o),t.forEach(r=>{if(e.findIndex(d=>{const c=F(d.options,r);return c&&(d.options=r,n==null||n(d,r,o)),c})!==-1||!(l!=null&&l.length?r.some(({uid:d})=>l.some(c=>d===c.uid)):!0))return;const h=u(r,o);e.push(h)})}function $(e,o){return e.map((t,u)=>o[u].options.findIndex(n=>n.uid===t))}function L(e,o){e.sort((t,u)=>parseInt($(C(t.options),o).join(""))-parseInt($(C(u.options),o).join("")))}const D=new WeakMap;function oe(e,o,t,u,n=!0){var r;const l=(r=D.get(e))!=null?r:(()=>{const i=b(()=>A(e.value));return D.set(e,i),i})();return{descartesOptions:l,add:i=>{ne(o.value,{variations:e.value,descartesOptions:l.value,updateItem:u,createItem:t,addItems:O(i)}),n&&L(o.value,e.value)},remove:()=>{te(o.value,{variations:e.value,descartesOptions:l.value,updateItem:u}),n&&L(o.value,e.value)}}}const le={style:{"margin-top":"30px"}},re=s("th",{scope:"col"},"\u5E93\u5B58",-1),ue=["onUpdate:modelValue"],se=["onUpdate:modelValue"],ce=B({setup(e){const o=[{name:"\u989C\u8272",options:["red","green","blue"]}],t=U([]),u=b(()=>t.value.filter(({options:c})=>c==null?void 0:c.length));t.value=o.map(c=>({name:c.name,options:c.options.map(x=>({uid:N(),value:x,selected:!1})),uid:""}));const n=U([]),{add:l,remove:r,descartesUidArray:i}=oe(u,n,void 0,void 0,!1),p=()=>{t.value.push({name:Date.now(),options:[]})},h=c=>{t.value.splice(c,1),r()},d=b(()=>u.value);return console.time("progress"),console.timeLog("progress",j([Array.from({length:50}),Array.from({length:50}),Array.from({length:50})])),console.timeEnd("progress"),(c,x)=>(a(),f("div",null,[(a(!0),f(g,null,y(t.value,(m,v)=>(a(),q(ee,{key:v,value:m,"onAdd:item":E(l),onRemove:_=>h(v)},null,8,["value","onAdd:item","onRemove"]))),128)),s("button",{onClick:p,style:{width:"100%"}},"+"),s("table",le,[s("caption",null," sku \u5217\u8868"+w(n.value.length),1),s("tbody",null,[s("tr",null,[(a(!0),f(g,null,y(E(d),(m,v)=>(a(),f("th",{scope:"col",key:v},w(m.name),1))),128)),re]),(a(!0),f(g,null,y(n.value,(m,v)=>(a(),f("tr",{key:v},[(a(!0),f(g,null,y(m.options,_=>(a(),f("th",{scope:"row",key:_.uid},[V(s("input",{"onUpdate:modelValue":R=>_.value=R},null,8,ue),[[k,_.value]])]))),128)),s("td",null,[V(s("input",{"onUpdate:modelValue":_=>m.stock=_,type:"number"},null,8,se),[[k,m.stock]])])]))),128))])])]))}});H(ce).mount("#app");
