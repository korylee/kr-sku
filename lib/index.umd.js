(function(t,h){typeof exports=="object"&&typeof module!="undefined"?h(exports,require("vue-demi")):typeof define=="function"&&define.amd?define(["exports","vue-demi"],h):(t=typeof globalThis!="undefined"?globalThis:t||self,h(t["@korylee/sku"]={},t["vue-demi"]))})(this,function(t,h){"use strict";function j(n){return n!=null&&n!==void 0?Array.isArray(n)?n:[n]:[]}function v(n){return n!=null&&n.length?n.length===1?n[0].map(u=>[u]):n.reduce((u,e)=>{const o=[];return u.forEach(i=>{e.forEach(f=>{o.push([...j(i),f])})}),o}):[]}function m(n,u){return!n.some(e=>!u.includes(e))}const D=()=>{};function g(n){const u=n.filter(({options:e})=>e==null?void 0:e.length).map(({options:e})=>e);return v(u)}const d=n=>n.map(u=>u.uid);function M(n,{variations:u,descartesOptions:e,updateItem:o=D}){const i=[],f=[];e=e!=null?e:g(u),n.forEach((r,p)=>{let V=!0;e.forEach((l,s)=>{m(d(l),d(r.options))&&(f[s]||(V=!1),r.options=l,o==null||o(r,l,u),f[s]=!0)}),V&&i.push(p)});const c=i.length;for(let r=c-1;r>=0;r--){const p=i[r];n.splice(p,1)}}function x(n,{variations:u,descartesOptions:e,createItem:o=c=>({options:c}),updateItem:i=D,addItems:f=[]}){e=e!=null?e:g(u),e.forEach(c=>{if(n.findIndex(l=>{const s=m(d(l.options),d(c));return s&&(l.options=c,i==null||i(l,c,u)),s})!==-1||!(f!=null&&f.length?c.some(({uid:l})=>f.some(s=>l===s.uid)):!0))return;const V=o(c,u);n.push(V)})}function A(n,u){return n.map((e,o)=>u[o].options.findIndex(i=>i.uid===e))}function E(n,u){n.sort((e,o)=>parseInt(A(d(e.options),u).join(""))-parseInt(A(d(o.options),u).join("")))}const O=new WeakMap;function w(n,u,e,o,i=!0){var c;const f=(c=O.get(n))!=null?c:(()=>{const r=h.computed(()=>g(n.value));return O.set(n,r),r})();return{descartesOptions:f,add:r=>{x(u.value,{variations:n.value,descartesOptions:f.value,updateItem:o,createItem:e,addItems:j(r)}),i&&E(u.value,n.value)},remove:()=>{M(u.value,{variations:n.value,descartesOptions:f.value,updateItem:o}),i&&E(u.value,n.value)}}}t.addVariationOption=x,t.getDescartesOptions=g,t.removeVariationOption=M,t.sortVariationOption=E,t.uidsToIndex=A,t.useVariationOption=w,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
