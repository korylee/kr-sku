(function(t,h){typeof exports=="object"&&typeof module!="undefined"?h(exports,require("vue-demi")):typeof define=="function"&&define.amd?define(["exports","vue-demi"],h):(t=typeof globalThis!="undefined"?globalThis:t||self,h(t["@korylee/sku"]={},t.vueDemi))})(this,function(t,h){"use strict";function E(n){return n!=null&&n!==void 0?Array.isArray(n)?n:[n]:[]}function x(n){return n!=null&&n.length?n.length===1?n[0].map(o=>[o]):n.reduce((o,e)=>{const u=[];return o.forEach(i=>{e.forEach(f=>{u.push([...E(i),f])})}),u}):[]}function j(n,o){return!n.some(e=>!o.includes(e))}const m=()=>{};function p(n){const o=n.filter(({options:e})=>!(e!=null&&e.length)).map(({options:e})=>e.map(({uid:u})=>u));return x(o)}function v(n,{variations:o,descartesUidArray:e,updateItem:u=m}){const i=[],f=[];e=e!=null?e:p(o),n.forEach((r,O)=>{let g=!0;e.forEach((l,s)=>{j(l,r.uids)&&(f[s]||(g=!1),r.uids=l,u==null||u(r,l,o),f[s]=!0)}),g&&i.push(O)});const c=i.length;for(let r=c-1;r>=0;r--){const O=i[r];n.splice(O,1)}}function D(n,{variations:o,descartesUidArray:e,createItem:u=c=>({uids:c}),updateItem:i=m,addItems:f=[]}){e=e!=null?e:p(o),e.forEach(c=>{if(n.findIndex(l=>{const s=j(l.uids,c);return s&&(l.uids=c,i==null||i(l,c,o)),s})!==-1||!(f!=null&&f.length?c.some(l=>f.some(s=>l===s.uid)):!0))return;const g=u(c,o);n.push(g)})}function V(n,o){return n.map((e,u)=>o[u].options.findIndex(i=>i.uid===e))}function d(n,o){n.sort((e,u)=>parseInt(V(e.uids,o).join(""))-parseInt(V(u.uids,o).join("")))}function C(n,o,e,u,i=!0){const f=h.computed(()=>p(n.value));return{descartesUidArray:f,add:c=>{D(o.value,{variations:n.value,descartesUidArray:f.value,updateItem:u,createItem:e,addItems:E(c)}),i&&d(o.value,n.value)},remove:()=>{v(o.value,{variations:n.value,descartesUidArray:f.value,updateItem:u}),i&&d(o.value,n.value)}}}t.addVariationOption=D,t.getDescartesUidArray=p,t.removeVariationOption=v,t.sortVariationOption=d,t.uidsToIndex=V,t.useVariationOption=C,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
