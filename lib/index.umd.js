(function(t,p){typeof exports=="object"&&typeof module!="undefined"?p(exports,require("vue-demi")):typeof define=="function"&&define.amd?define(["exports","vue-demi"],p):(t=typeof globalThis!="undefined"?globalThis:t||self,p(t["@korylee/sku"]={},t["vue-demi"]))})(this,function(t,p){"use strict";function j(n){return n!=null&&n!==void 0?Array.isArray(n)?n:[n]:[]}function C(n){return n!=null&&n.length?n.length===1?n[0].map(o=>[o]):n.reduce((o,e)=>{const u=[];return o.forEach(i=>{e.forEach(f=>{u.push([...j(i),f])})}),u}):[]}function m(n,o){return!n.some(e=>!o.includes(e))}const v=()=>{};function O(n){const o=n.filter(({options:e})=>e==null?void 0:e.length).map(({options:e})=>e);return C(o)}const h=n=>n.map(o=>o.uid);function x(n,{variations:o,descartesUidArray:e,updateItem:u=v}){const i=[],f=[];e=e!=null?e:O(o),n.forEach((r,g)=>{let V=!0;e.forEach((l,s)=>{m(h(l),h(r.options))&&(f[s]||(V=!1),r.options=l,u==null||u(r,l,o),f[s]=!0)}),V&&i.push(g)});const c=i.length;for(let r=c-1;r>=0;r--){const g=i[r];n.splice(g,1)}}function D(n,{variations:o,descartesUidArray:e,createItem:u=c=>({options:c}),updateItem:i=v,addItems:f=[]}){e=e!=null?e:O(o),e.forEach(c=>{if(n.findIndex(l=>{const s=m(h(l.options),h(c));return s&&(l.options=c,i==null||i(l,c,o)),s})!==-1||!(f!=null&&f.length?c.some(({uid:l})=>f.some(s=>l===s.uid)):!0))return;const V=u(c,o);n.push(V)})}function d(n,o){return n.map((e,u)=>o[u].options.findIndex(i=>i.uid===e))}function E(n,o){n.sort((e,u)=>parseInt(d(h(e.options),o).join(""))-parseInt(d(h(u.options),o).join("")))}function M(n,o,e,u,i=!0){const f=p.computed(()=>O(n.value));return{descartesUidArray:f,add:c=>{D(o.value,{variations:n.value,descartesUidArray:f.value,updateItem:u,createItem:e,addItems:j(c)}),i&&E(o.value,n.value)},remove:()=>{x(o.value,{variations:n.value,descartesUidArray:f.value,updateItem:u}),i&&E(o.value,n.value)}}}t.addVariationOption=D,t.getDescartesOptions=O,t.removeVariationOption=x,t.sortVariationOption=E,t.uidsToIndex=d,t.useVariationOption=M,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
